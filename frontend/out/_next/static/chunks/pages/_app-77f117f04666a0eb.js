(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{3837:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return r(3812)}])},4078:function(e,t,r){"use strict";r.d(t,{H:function(){return h},a:function(){return y}});var a=r(5893),n=r(7294);let o="https://api.botslinger.ai",l=()=>{let e=localStorage.getItem("token");return{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}}},u=async e=>{let t=await e.json();if(!e.ok)throw Error(t.message||"Something went wrong");return t},s={register:async e=>u(await fetch("".concat(o,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),login:async e=>u(await fetch("".concat(o,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),getMe:async()=>u(await fetch("".concat(o,"/auth/me"),{method:"GET",headers:l()})),logout:async()=>u(await fetch("".concat(o,"/auth/logout"),{method:"POST",headers:l()})),deleteUser:async()=>u(await fetch("".concat(o,"/auth/me"),{method:"DELETE",headers:l()})),updateGoHighLevelIntegration:async e=>u(await fetch("".concat(o,"/auth/gohighlevel-integration"),{method:"PUT",headers:l(),body:JSON.stringify(e)}))},i=(0,n.createContext)(),c={user:null,token:null,isAuthenticated:!1,loading:!0,error:null},d=(e,t)=>{switch(t.type){case"AUTH_START":return{...e,loading:!0,error:null};case"AUTH_SUCCESS":return{...e,user:t.payload.user,token:t.payload.token,isAuthenticated:!0,loading:!1,error:null};case"AUTH_FAILURE":return{...e,user:null,token:null,isAuthenticated:!1,loading:!1,error:t.payload};case"LOGOUT":return{...e,user:null,token:null,isAuthenticated:!1,loading:!1,error:null};case"UPDATE_USER":return{...e,user:{...e.user,...t.payload}};case"CLEAR_ERROR":return{...e,error:null};default:return e}},h=e=>{let{children:t}=e,[r,o]=(0,n.useReducer)(d,c);(0,n.useEffect)(()=>{let e=localStorage.getItem("token");(async()=>{if(e)try{o({type:"AUTH_START"});let t=await s.getMe();o({type:"AUTH_SUCCESS",payload:{user:t.user,token:e}})}catch(e){o({type:"AUTH_FAILURE",payload:e.message}),localStorage.removeItem("token")}else o({type:"AUTH_FAILURE",payload:null})})()},[]);let l=async e=>{try{o({type:"AUTH_START"});let t=await s.login(e);return localStorage.setItem("token",t.token),o({type:"AUTH_SUCCESS",payload:{user:t.user,token:t.token}}),t}catch(e){throw o({type:"AUTH_FAILURE",payload:e.message}),e}},u=async e=>{try{o({type:"AUTH_START"});let t=await s.register(e);return localStorage.setItem("token",t.token),o({type:"AUTH_SUCCESS",payload:{user:t.user,token:t.token}}),t}catch(e){throw o({type:"AUTH_FAILURE",payload:e.message}),e}},h=async()=>{try{await s.logout()}catch(e){console.error("Logout error:",e)}finally{localStorage.removeItem("token"),o({type:"LOGOUT"})}},y=async()=>{try{o({type:"AUTH_START"}),await s.deleteUser(),localStorage.removeItem("token"),o({type:"LOGOUT"})}catch(e){throw console.error("Delete user error:",e),o({type:"AUTH_FAILURE",payload:e.message}),e}},p={user:r.user,token:r.token,isAuthenticated:r.isAuthenticated,loading:r.loading,error:r.error,login:l,register:u,logout:h,updateUser:e=>{o({type:"UPDATE_USER",payload:e})},deleteUser:y,updateGoHighLevelIntegration:s.updateGoHighLevelIntegration,clearError:()=>{o({type:"CLEAR_ERROR"})}};return(0,a.jsx)(i.Provider,{value:p,children:t})},y=()=>{let e=(0,n.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},3812:function(e,t,r){"use strict";r.r(t);var a=r(5893),n=r(4078);r(3434),t.default=function(e){let{Component:t,pageProps:r}=e;return(0,a.jsx)(n.H,{children:(0,a.jsx)(t,{...r})})}},3434:function(){}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[774,179],function(){return t(3837),t(3079)}),_N_E=e.O()}]);